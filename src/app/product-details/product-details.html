<div class="container mt-4" *ngIf="product() as p">
  <div class="row">
    <!-- Product Images -->
    <div class="col-md-6">
      <div class="main-image">
        <img [src]="p.thumbnail" class="img-fluid rounded" alt="{{ p.title }}" />
      </div>
      <div class="mt-3 d-flex">
        @for (image of p.images.slice(0, 4); track image) {
        <img
          [src]="image"
          class="img-thumbnail me-2"
          style="width: 80px; height: 80px; object-fit: cover"
          alt="Product Image"
        />
        }
      </div>
    </div>

    <!-- Product Details -->
    <div class="col-md-6">
      <h2>{{ p.title }}</h2>
      <p class="text-muted">{{ p.brand }}</p>
      <h4 class="text-primary">${{ p.price }}</h4>
      <p>{{ p.description }}</p>

      <!-- Stock Status -->
      <span
        class="badge"
        [class.bg-success]="p.stock > 10"
        [class.bg-warning]="p.stock <= 10 && p.stock > 0"
        [class.bg-danger]="p.stock === 0"
      >
        {{ p.stock > 0 ? p.stock + ' in stock' : 'Out of stock' }}
      </span>

      <!-- Rating -->
      <div class="mt-3">
        <ng-container *ngFor="let star of [1, 2, 3, 4, 5]">
          <i
            class="bi"
            [class.bi-star-fill]="star <= p.rating"
            [class.bi-star]="star > p.rating"
            style="color: gold"
          ></i>
        </ng-container>
      </div>

      <!-- Buttons -->
      <div class="mt-4">
        <button class="btn btn-primary me-2" (click)="addToCart(p)" [disabled]="p.stock === 0">
          Add to Cart
        </button>
        <button class="btn btn-outline-danger" (click)="addToFavorites(p)">
          â™¥ Add to Favorites
        </button>
      </div>
    </div>
  </div>

  <!-- Reviews Section -->
  <div class="row mt-5">
    <div class="col-12">
      <h3>Customer Reviews</h3>
      @if (p.reviews.length > 0) {
      <ul class="list-group">
        @for (review of p.reviews; track review.date) {
        <li class="list-group-item">
          <strong>{{ review.reviewerName }}</strong>
          <span class="text-muted"> - {{ review.date }}</span>
          <p>{{ review.comment }}</p>
        </li>
        }
      </ul>
      } @else {
      <p class="text-muted">No reviews yet.</p>
      }
    </div>
  </div>
</div>
